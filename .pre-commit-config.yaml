default_language_version:
  python: python3.11

repos:
  - repo: https://github.com/hadialqattan/pycln
    rev: v2.6.0
    hooks:
      - name: pycln - python cleanup tool (removes unused imports)
        id: pycln
        args: [--all]

  - repo: https://github.com/hukkin/mdformat
    rev: 1.0.0
    hooks:
      - id: mdformat
        name: markdown - Markdown formatter
        exclude: "CONTRIBUTING.md" # Formatted Markdown renders to different HTML than input Markdown. This is a bug ...

  - repo: https://github.com/commitizen-tools/commitizen
    rev: v4.11.6
    hooks:
      - id: commitizen
        name: commitizen - Conventional commit messages check
        stages: [commit-msg]

  - repo: local
    hooks:
      - id: black
        name: black - Python code formatter
        entry: ./.venv/bin/black tests/ plugins/
        language: system
        types: [python]
        require_serial: False

      - id: ruff-format
        name: ruff - Python code formatter (check mode)
        entry: ./.venv/bin/ruff format --check
        language: system
        types: [python]
        require_serial: False

      - id: ruff-lint
        name: ruff - Pythom code linting (check mode & implement fix)
        entry: ./.venv/bin/ruff check --fix
        language: system
        types: [python]
        require_serial: False

      - id: mypy
        name: mypy - Python static type checks
        entry: .venv/bin/mypy
        language: system
        types: [python]
        require_serial: False
        args: ["--config-file=./pyproject.toml"]

      - id: pytest
        name: pytest - Run unit and integration tests
        entry: ./.venv/bin/pytest
        language: system
        types: [python]
        require_serial: False
        pass_filenames: false 

      # ----------------------------------------------------------------------------------------------------------
      # Manual execution of `ansible-test` requires your project to follow the standard Ansible collection layout:
      #     ansible_collections/<namespace>/<collection>
      #
      # Moved to GitHub CI / local testing using `act`
      #Â 
      # ----------------------------------------------------------------------------------------------------------
      #- id: ansible-test sanity
      #  name: ansible-test - Run sanity checks
      #  entry: ansible-test sanity
      #  language: system
      #  types: [python]
      #  require_serial: True
